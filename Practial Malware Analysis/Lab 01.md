#malwareanalysis #lab

# Lab 1-1


![[lab_01_questions.png]]

## 1.

**exe**
![[lab_01_virustotal_exe.png]]
**dll**
![[lab_01_virustotal_dll.png]]


## 2.
**exe**: 2010-12-19 17:16:19
**dll**: 2010-12-19 17:16:38

## 3.
Well the strings are most likely encrypted and there are only a few imports for each bin. However the sections sizes looks alright. So these binaries are probably not packed.

## 4.
Looks like the exe is creating/reading files on the disk while the dll creates new process which connects to the internet. 

## 5.
The **.exe** is probably just loading the dll (There is no LoadLibrary import tho) so it's host-based.

## 6.
The **.dll** is importing the WS2_32.dll which is handling connection to the internet, it also has an ip adress that we can find while looking into the strings so it's network-based.

## 7.
The exe is creating/reading files on/from the disk while dll probaly streams them over the network



# Lab 1-2
![[lab_02_questions.png]]
## 1.
![[lab_02_virustotal_exe.png]]

## 2.
Yeah the file is packed, it's section names are weird, and their vsizes doesn't match up the raw size on the disk. 
Furthermore thanks to DIE: 
![[lab_02_die_exe.png]]

We know that the file have been packed using [upx packer](https://upx.github.io/). And that we can easly unpack it running
```shell
upx -d Lab01-02.exe
```

## 3.
Looks like the file crates a service which is opening [this](http://www.malwareanalysisbook.com) url delayed by some time. 

## 4.
There is an url that is being opened in a loop by the `InternetOpenUrlA` with a custom delay.



# Lab 1-3

![[lab_03_questions.png]]
## 1.
![[lab_03_virustotal_exe.png]]

## 2.
![[lab_03_sections_exe.png]]
Yeah the file is packed. Furthermore DIE tells us that it was packed using FSG packer (1.0)

I've used [this](https://www.aldeid.com/wiki/Category:Digital-Forensics/Computer-Forensics/Anti-Reverse-Engineering/Packers/FSG) FSG unpacking guide. And thanks to that we successfully unpacked that binary.

## 3.
It looks like the binary is loading several ms dlls and then opens an url. Due to the manual unpacking I can't really tell 

## 4.
Url in the strings.


# Lab 1-4
![[lab_04_questions.png]]
## 1.
![[lab_04_virustotal_exe.png]]
## 2.
After checking the section sizes and strings I think we can say that the binary isn't packed.
![[lab_04_sections_exe.png]]
## 3.
Compilation timestamp: 2019-08-31 00:26:59

## 4.
Most likely **Lab01–04.exe** might modify permissions to write to directory, potentially to replace with the hidden file, which performs network functionality to download and execute more malware with the binary hidden in it's resource.